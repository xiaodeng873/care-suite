-- 擴充問題庫 - 為每個專業（除醫生外）增加10個問題
-- 創建日期: 2026-01-05

-- 先添加 problem_subcategory 欄位（如果不存在）
ALTER TABLE problem_library ADD COLUMN IF NOT EXISTS subcategory TEXT;
ALTER TABLE problem_library ADD COLUMN IF NOT EXISTS keywords TEXT[];

-- 為現有記錄設定子分類
UPDATE problem_library SET subcategory = '皮膚護理', keywords = ARRAY['皮膚', '傷口', '壓瘡', '潰瘍'] WHERE code = 'N001';
UPDATE problem_library SET subcategory = '營養護理', keywords = ARRAY['營養', '進食', '體重', '飲食'] WHERE code = 'N002';
UPDATE problem_library SET subcategory = '活動護理', keywords = ARRAY['活動', '行動', '跌倒', '輔具'] WHERE code = 'N003';
UPDATE problem_library SET subcategory = '排泄護理', keywords = ARRAY['排泄', '失禁', '如廁', '尿布'] WHERE code = 'N004';
UPDATE problem_library SET subcategory = '步態訓練', keywords = ARRAY['步態', '行走', '平衡', '跌倒'] WHERE code = 'PT001';
UPDATE problem_library SET subcategory = '關節活動', keywords = ARRAY['關節', '活動度', '僵硬', '伸展'] WHERE code = 'PT002';
UPDATE problem_library SET subcategory = '日常生活', keywords = ARRAY['自理', '生活', '獨立', '日常'] WHERE code = 'OT001';
UPDATE problem_library SET subcategory = '吞嚥功能', keywords = ARRAY['吞嚥', '嗆咳', '進食', '噎塞'] WHERE code = 'ST001';
UPDATE problem_library SET subcategory = '溝通功能', keywords = ARRAY['溝通', '語言', '表達', '理解'] WHERE code = 'ST002';
UPDATE problem_library SET subcategory = '體重管理', keywords = ARRAY['體重', 'BMI', '營養', '熱量'] WHERE code = 'DT001';
UPDATE problem_library SET subcategory = '糖尿病', keywords = ARRAY['糖尿', '血糖', '飲食', '控制'] WHERE code = 'DT002';

-- ============================================
-- 護理類 - 新增10個問題
-- ============================================
INSERT INTO problem_library (code, name, category, subcategory, description, expected_goals, interventions, keywords) VALUES
  ('N005', '睡眠障礙', '護理', '睡眠護理', '院友有入睡困難、早醒或睡眠品質差的問題',
   ARRAY['改善睡眠品質', '增加總睡眠時間', '減少夜間醒來次數'],
   ARRAY['建立規律作息', '營造舒適睡眠環境', '減少白天小睡', '睡前放鬆活動', '必要時諮詢醫生用藥'],
   ARRAY['睡眠', '失眠', '入睡', '睡眠品質', '夜醒']),
  
  ('N006', '疼痛管理', '護理', '疼痛護理', '院友有慢性疼痛或急性疼痛需要管理',
   ARRAY['疼痛程度降低', '提升生活品質', '減少止痛藥依賴'],
   ARRAY['定期疼痛評估', '非藥物止痛方法', '正確用藥指導', '記錄疼痛日誌', '物理治療配合'],
   ARRAY['疼痛', '止痛', '慢性痛', '舒緩', '鎮痛']),
  
  ('N007', '感染風險', '護理', '感染控制', '院友有感染風險或反覆感染問題',
   ARRAY['預防感染發生', '早期發現感染徵兆', '縮短感染恢復時間'],
   ARRAY['手部衛生宣教', '定期監測生命徵象', '傷口護理', '環境清潔消毒', '營養支持'],
   ARRAY['感染', '發燒', '傷口', '衛生', '免疫']),
  
  ('N008', '脫水風險', '護理', '水份管理', '院友飲水量不足或有脫水風險',
   ARRAY['維持適當水份攝取', '預防脫水', '改善皮膚彈性'],
   ARRAY['鼓勵定時飲水', '記錄每日飲水量', '提供多元飲品選擇', '監測尿液顏色', '觀察脫水徵兆'],
   ARRAY['脫水', '飲水', '水份', '尿液', '口渴']),
  
  ('N009', '便秘問題', '護理', '排泄護理', '院友有排便困難或便秘問題',
   ARRAY['維持規律排便', '軟化糞便', '減少使用瀉藥'],
   ARRAY['增加膳食纖維', '鼓勵適量飲水', '腹部按摩', '定時如廁習慣', '適當活動'],
   ARRAY['便秘', '排便', '膳食纖維', '腸道', '瀉藥']),
  
  ('N010', '呼吸功能障礙', '護理', '呼吸護理', '院友有呼吸困難或氧氣需求',
   ARRAY['維持血氧飽和度', '減輕呼吸困難', '預防肺部併發症'],
   ARRAY['定期監測血氧', '正確氧氣使用', '深呼吸訓練', '姿勢調整', '拍痰護理'],
   ARRAY['呼吸', '血氧', '氧氣', '喘', '肺部']),
  
  ('N011', '認知功能下降', '護理', '認知護理', '院友有記憶力減退或認知功能問題',
   ARRAY['延緩認知退化', '維持日常功能', '提升生活品質'],
   ARRAY['認知刺激活動', '現實導向治療', '記憶訓練', '安全環境布置', '家屬教育'],
   ARRAY['認知', '記憶', '失智', '混亂', '定向']),
  
  ('N013', '跌倒高風險', '護理', '安全護理', '院友有高跌倒風險需要預防措施',
   ARRAY['預防跌倒發生', '減少跌倒傷害', '維持活動能力'],
   ARRAY['跌倒風險評估', '環境安全檢查', '適當輔具使用', '夜間照明', '定時巡視'],
   ARRAY['跌倒', '平衡', '安全', '輔具', '風險']),
  
  ('N014', '藥物管理問題', '護理', '藥物護理', '院友有多種藥物或服藥依從性問題',
   ARRAY['正確服藥', '減少藥物副作用', '提高服藥依從性'],
   ARRAY['藥物整理核對', '服藥時間提醒', '副作用監測', '藥物衛教', '與醫生溝通調整'],
   ARRAY['藥物', '服藥', '副作用', '依從性', '多重用藥'])
ON CONFLICT (code) DO UPDATE SET
  subcategory = EXCLUDED.subcategory,
  keywords = EXCLUDED.keywords;

-- ============================================
-- 社工類 - 新增10個問題
-- ============================================
INSERT INTO problem_library (code, name, category, subcategory, description, expected_goals, interventions, keywords) VALUES
  ('SW001', '家庭關係疏離', '社工', '家庭支援', '院友與家人聯繫減少或關係緊張',
   ARRAY['改善家庭溝通', '增加家人探訪次數', '促進家庭和諧'],
   ARRAY['家屬會談', '調解家庭糾紛', '安排家庭活動', '電話/視像探訪', '家屬支援小組'],
   ARRAY['家庭', '家人', '探訪', '關係', '親屬']),
  
  ('SW002', '經濟困難', '社工', '經濟支援', '院友或家屬面對經濟壓力或費用問題',
   ARRAY['減輕經濟負擔', '獲取適當資助', '穩定繳費'],
   ARRAY['經濟狀況評估', '申請政府津貼', '慈善基金轉介', '費用分期安排', '社區資源連結'],
   ARRAY['經濟', '費用', '津貼', '資助', '財務']),
  
  ('SW003', '社交孤立', '社工', '社交支援', '院友缺乏社交活動或人際互動',
   ARRAY['增加社交互動', '建立友誼關係', '提升歸屬感'],
   ARRAY['鼓勵參與院舍活動', '安排同房交流', '義工探訪', '興趣小組', '節日慶祝活動'],
   ARRAY['社交', '孤獨', '朋友', '活動', '互動']),
  
  ('SW004', '入住適應困難', '社工', '適應支援', '新入住院友對環境或生活難以適應',
   ARRAY['縮短適應期', '減輕焦慮情緒', '建立歸屬感'],
   ARRAY['入住輔導', '環境介紹', '院友互助配對', '定期跟進會談', '家屬協調'],
   ARRAY['適應', '入住', '新院友', '環境', '過渡']),
  
  ('SW005', '喪親哀傷', '社工', '心理支援', '院友經歷親人離世的哀傷情緒',
   ARRAY['健康處理哀傷', '恢復日常功能', '找到新的生活意義'],
   ARRAY['哀傷輔導', '情緒支持', '回憶活動', '宗教/靈性支援', '轉介專業心理服務'],
   ARRAY['哀傷', '喪親', '死亡', '離世', '悲傷']),
  
  ('SW006', '預設照顧計劃', '社工', '生命關懷', '院友需要討論晚期照顧意願',
   ARRAY['明確照顧意願', '尊重個人選擇', '減輕家屬決策壓力'],
   ARRAY['預設照顧計劃會談', '記錄照顧意願', '家屬溝通協調', '定期檢視更新', '跨專業團隊協作'],
   ARRAY['預設', '晚期', '意願', '照顧計劃', 'ACP']),
  
  ('SW007', '被虐待/忽視風險', '社工', '保護支援', '院友有被虐待、忽視或自我忽視風險',
   ARRAY['確保院友安全', '消除虐待風險', '提供適當保護'],
   ARRAY['風險評估', '保護計劃', '多專業會議', '家屬教育', '必要時轉介相關機構'],
   ARRAY['虐待', '忽視', '安全', '保護', '風險']),
  
  ('SW008', '法律/文件問題', '社工', '法律支援', '院友需要處理法律文件或授權安排',
   ARRAY['完成必要法律文件', '保障院友權益', '避免糾紛'],
   ARRAY['協助申請證件', '轉介法律服務', '見證簽署文件', '持久授權書安排', '遺囑諮詢轉介'],
   ARRAY['法律', '文件', '授權', '證件', '遺囑']),
  
  ('SW009', '精神健康問題', '社工', '心理支援', '院友有精神健康問題需要支援',
   ARRAY['穩定精神狀態', '配合治療', '提升生活品質'],
   ARRAY['情緒觀察記錄', '支援性會談', '精神科覆診跟進', '藥物依從性支援', '危機介入計劃'],
   ARRAY['精神', '心理', '情緒', '抑鬱', '焦慮']),
  
  ('SW010', '出院/轉介安排', '社工', '過渡支援', '院友需要出院或轉至其他服務',
   ARRAY['順利過渡', '銜接適當服務', '家屬配合準備'],
   ARRAY['出院計劃會議', '社區資源連結', '家居評估安排', '復康服務轉介', '跟進支援'],
   ARRAY['出院', '轉介', '過渡', '社區', '銜接'])
ON CONFLICT (code) DO UPDATE SET
  subcategory = EXCLUDED.subcategory,
  keywords = EXCLUDED.keywords;

-- ============================================
-- 物理治療類 - 新增10個問題
-- ============================================
INSERT INTO problem_library (code, name, category, subcategory, description, expected_goals, interventions, keywords) VALUES
  ('PT003', '肌力下降', '物理治療', '肌力訓練', '院友肌肉力量減弱影響日常功能',
   ARRAY['增強肌肉力量', '改善功能表現', '預防肌少症'],
   ARRAY['阻力訓練', '漸進式負重運動', '功能性訓練', '營養配合', '定期評估'],
   ARRAY['肌力', '力量', '肌肉', '無力', '肌少症']),
  
  ('PT004', '平衡能力差', '物理治療', '平衡訓練', '院友平衡能力不足易跌倒',
   ARRAY['改善平衡能力', '減少跌倒風險', '增加活動信心'],
   ARRAY['靜態平衡訓練', '動態平衡訓練', '本體感覺訓練', '視覺訓練', '太極/瑜伽'],
   ARRAY['平衡', '跌倒', '站立', '重心', '穩定']),
  
  ('PT005', '心肺功能下降', '物理治療', '心肺復健', '院友心肺耐力不足影響活動能力',
   ARRAY['增強心肺功能', '提升活動耐力', '減輕疲勞感'],
   ARRAY['有氧運動訓練', '呼吸運動', '階梯訓練', '漸進式運動計劃', '生命徵象監測'],
   ARRAY['心肺', '耐力', '疲勞', '呼吸', '體能']),
  
  ('PT006', '姿勢異常', '物理治療', '姿勢矯正', '院友有駝背、側彎或姿勢不良',
   ARRAY['改善姿勢對稱', '減輕因姿勢引起的疼痛', '預防惡化'],
   ARRAY['姿勢評估', '伸展運動', '核心肌群訓練', '支架/輔具使用', '坐姿站姿指導'],
   ARRAY['姿勢', '駝背', '側彎', '脊柱', '矯正']),
  
  ('PT007', '水腫問題', '物理治療', '水腫處理', '院友有肢體水腫需要處理',
   ARRAY['減輕水腫程度', '改善肢體功能', '預防皮膚問題'],
   ARRAY['抬高患肢', '按摩引流', '壓力治療', '運動促進循環', '皮膚護理'],
   ARRAY['水腫', '腫脹', '肢體', '淋巴', '循環']),
  
  ('PT008', '轉移能力差', '物理治療', '轉移訓練', '院友坐站轉移、床椅轉移困難',
   ARRAY['安全獨立轉移', '減少照顧者負擔', '預防意外'],
   ARRAY['轉移技巧訓練', '下肢肌力訓練', '輔具使用', '照顧者指導', '環境調整'],
   ARRAY['轉移', '坐站', '床', '輪椅', '扶抱']),
  
  ('PT009', '疼痛康復', '物理治療', '疼痛管理', '院友有肌肉骨骼疼痛需物理治療',
   ARRAY['減輕疼痛程度', '恢復功能', '預防復發'],
   ARRAY['熱敷/冷敷', '電療', '超聲波治療', '手法治療', '運動治療'],
   ARRAY['疼痛', '物理治療', '康復', '電療', '熱敷']),
  
  ('PT010', '中風後康復', '物理治療', '神經康復', '院友中風後需要物理治療康復',
   ARRAY['恢復肢體功能', '改善步態', '增加獨立性'],
   ARRAY['神經發展治療', '功能性訓練', '步態訓練', '輔具訓練', '家居運動計劃'],
   ARRAY['中風', '偏癱', '神經', '康復', '復健']),
  
  ('PT011', '骨折後康復', '物理治療', '骨科康復', '院友骨折後需要康復訓練',
   ARRAY['恢復關節活動', '重建肌力', '恢復日常功能'],
   ARRAY['漸進式活動', '負重訓練', '關節活動', '疤痕處理', '功能訓練'],
   ARRAY['骨折', '骨科', '康復', '負重', '癒合']),
  
  ('PT012', '帕金森氏症管理', '物理治療', '神經康復', '院友有帕金森氏症需要運動治療',
   ARRAY['維持活動能力', '改善步態凍結', '延緩功能退化'],
   ARRAY['大動作訓練', '節奏訓練', '平衡訓練', '轉身訓練', '言語配合動作'],
   ARRAY['帕金森', '震顫', '僵硬', '動作緩慢', '步態凍結'])
ON CONFLICT (code) DO UPDATE SET
  subcategory = EXCLUDED.subcategory,
  keywords = EXCLUDED.keywords;

-- ============================================
-- 職業治療類 - 新增10個問題
-- ============================================
INSERT INTO problem_library (code, name, category, subcategory, description, expected_goals, interventions, keywords) VALUES
  ('OT002', '精細動作障礙', '職業治療', '上肢功能', '院友手部精細動作能力下降',
   ARRAY['改善手部靈活度', '提升日常自理能力', '維持功能'],
   ARRAY['手部運動', '精細動作訓練', '輔具使用', '日常任務訓練', '感覺刺激'],
   ARRAY['精細動作', '手部', '靈活', '抓握', '操作']),
  
  ('OT003', '進食困難', '職業治療', '日常生活', '院友自行進食有困難',
   ARRAY['獨立進食', '減少食物濺漏', '維持進食尊嚴'],
   ARRAY['進食輔具評估', '進食訓練', '姿勢調整', '適應性餐具', '環境調整'],
   ARRAY['進食', '餐具', '自理', '吃飯', '輔具']),
  
  ('OT004', '穿衣困難', '職業治療', '日常生活', '院友穿脫衣物有困難',
   ARRAY['獨立穿衣', '減少穿衣時間', '維持自尊'],
   ARRAY['穿衣訓練', '穿衣輔具', '衣物改造建議', '順序指導', '單手穿衣技巧'],
   ARRAY['穿衣', '衣服', '自理', '拉鍊', '扣鈕']),
  
  ('OT005', '如廁困難', '職業治療', '日常生活', '院友如廁自理能力下降',
   ARRAY['獨立如廁', '維持衛生', '保護隱私'],
   ARRAY['如廁訓練', '環境改造', '輔具評估', '轉移訓練', '清潔技巧指導'],
   ARRAY['如廁', '廁所', '自理', '衛生', '轉移']),
  
  ('OT006', '認知訓練需要', '職業治療', '認知功能', '院友認知功能需要訓練維持',
   ARRAY['維持認知功能', '延緩退化', '改善日常表現'],
   ARRAY['記憶訓練', '注意力訓練', '問題解決訓練', '時間管理', '現實導向'],
   ARRAY['認知', '記憶', '注意力', '思維', '訓練']),
  
  ('OT007', '輪椅使用評估', '職業治療', '輔具評估', '院友需要輪椅評估或調整',
   ARRAY['正確使用輪椅', '預防壓瘡', '提升舒適度'],
   ARRAY['輪椅評估', '座墊評估', '擺位調整', '使用訓練', '定期檢查'],
   ARRAY['輪椅', '擺位', '座墊', '輔具', '減壓']),
  
  ('OT008', '環境安全評估', '職業治療', '環境改造', '院友居住環境需要安全評估',
   ARRAY['消除安全隱患', '提升獨立性', '預防意外'],
   ARRAY['環境評估', '改造建議', '扶手安裝', '照明改善', '動線規劃'],
   ARRAY['環境', '安全', '家居', '改造', '無障礙']),
  
  ('OT009', '康樂活動參與', '職業治療', '康樂治療', '院友康樂活動參與度低',
   ARRAY['增加活動參與', '提升生活品質', '建立興趣'],
   ARRAY['興趣評估', '活動配對', '團體活動', '一對一活動', '適應性活動設計'],
   ARRAY['康樂', '活動', '興趣', '參與', '生活品質']),
  
  ('OT010', '上肢功能障礙', '職業治療', '上肢功能', '院友上肢活動功能受限',
   ARRAY['改善上肢功能', '增加活動範圍', '恢復日常能力'],
   ARRAY['上肢運動', '功能性訓練', '輔具使用', '日常任務練習', '力量訓練'],
   ARRAY['上肢', '手臂', '肩膀', '功能', '活動範圍']),
  
  ('OT011', '視覺感知問題', '職業治療', '感知訓練', '院友有視覺感知或忽略問題',
   ARRAY['改善視覺感知', '減少日常困難', '提升安全'],
   ARRAY['視覺掃描訓練', '感知訓練', '環境標示', '對比度增強', '代償策略'],
   ARRAY['視覺', '感知', '忽略', '空間', '辨認'])
ON CONFLICT (code) DO UPDATE SET
  subcategory = EXCLUDED.subcategory,
  keywords = EXCLUDED.keywords;

-- ============================================
-- 言語治療類 - 新增10個問題
-- ============================================
INSERT INTO problem_library (code, name, category, subcategory, description, expected_goals, interventions, keywords) VALUES
  ('ST003', '聲音障礙', '言語治療', '聲音功能', '院友聲音沙啞、微弱或異常',
   ARRAY['改善聲音質素', '增加音量', '減輕聲帶負擔'],
   ARRAY['聲音治療', '呼吸訓練', '聲帶保健教育', '放大器使用', '避免用聲過度'],
   ARRAY['聲音', '沙啞', '音量', '聲帶', '失聲']),
  
  ('ST004', '流暢性障礙', '言語治療', '言語功能', '院友說話不流暢或有口吃',
   ARRAY['改善說話流暢性', '減輕焦慮', '提升溝通信心'],
   ARRAY['流暢性技巧訓練', '放慢語速', '呼吸控制', '心理支持', '環境調整'],
   ARRAY['流暢', '口吃', '說話', '結巴', '焦慮']),
  
  ('ST005', '失語症', '言語治療', '語言功能', '院友理解或表達語言有障礙',
   ARRAY['改善語言理解', '增加表達能力', '維持溝通功能'],
   ARRAY['語言治療', '輔助溝通', '家屬教育', '日常練習', '多模式溝通'],
   ARRAY['失語', '語言', '理解', '表達', '中風']),
  
  ('ST006', '構音障礙', '言語治療', '言語功能', '院友發音不清或含糊',
   ARRAY['改善發音清晰度', '提升說話可理解度', '增加溝通效率'],
   ARRAY['構音訓練', '口腔肌肉運動', '放慢語速', '過度發音練習', '輔助溝通'],
   ARRAY['構音', '發音', '清晰', '含糊', '口齒']),
  
  ('ST007', '餵食安全問題', '言語治療', '吞嚥功能', '院友進食時有窒息或吸入風險',
   ARRAY['安全進食', '預防吸入性肺炎', '維持營養'],
   ARRAY['吞嚥評估', '食物質地調整', '餵食技巧指導', '姿勢調整', '照顧者培訓'],
   ARRAY['餵食', '安全', '吸入', '窒息', '質地']),
  
  ('ST008', '口腔功能障礙', '言語治療', '口腔功能', '院友口腔肌肉功能下降',
   ARRAY['改善口腔功能', '減少流涎', '提升進食能力'],
   ARRAY['口腔運動', '感覺刺激', '口腔衛生指導', '冷刺激', '肌肉強化'],
   ARRAY['口腔', '流涎', '口水', '肌肉', '舌頭']),
  
  ('ST009', '認知溝通障礙', '言語治療', '認知溝通', '院友因認知問題影響溝通',
   ARRAY['維持有效溝通', '減少溝通困難', '提升互動品質'],
   ARRAY['溝通策略訓練', '環境調整', '輔助工具', '家屬指導', '結構化對話'],
   ARRAY['認知', '溝通', '失智', '對話', '理解']),
  
  ('ST010', '氣管切開後溝通', '言語治療', '特殊需要', '氣管切開院友需要溝通支援',
   ARRAY['建立溝通方式', '減少挫折感', '維持社交互動'],
   ARRAY['說話瓣膜評估', '輔助溝通工具', '非語言溝通訓練', '家屬教育', '團隊協作'],
   ARRAY['氣管切開', '溝通', '說話瓣膜', '輔助', '非語言']),
  
  ('ST011', '聽力與溝通問題', '言語治療', '聽覺溝通', '院友聽力問題影響溝通',
   ARRAY['改善溝通效率', '正確使用助聽器', '減少溝通誤解'],
   ARRAY['溝通策略指導', '助聽器使用訓練', '環境調整建議', '讀唇訓練', '書寫溝通'],
   ARRAY['聽力', '助聽器', '耳聾', '溝通', '聽覺']),
  
  ('ST012', '多語言溝通問題', '言語治療', '特殊需要', '院友因語言文化差異溝通困難',
   ARRAY['建立有效溝通', '尊重文化背景', '減少誤解'],
   ARRAY['翻譯支援', '圖片溝通', '家屬協助', '文化敏感度培訓', '簡化語言'],
   ARRAY['語言', '文化', '翻譯', '母語', '外語'])
ON CONFLICT (code) DO UPDATE SET
  subcategory = EXCLUDED.subcategory,
  keywords = EXCLUDED.keywords;

-- ============================================
-- 營養師類 - 新增10個問題
-- ============================================
INSERT INTO problem_library (code, name, category, subcategory, description, expected_goals, interventions, keywords) VALUES
  ('DT003', '營養不良風險', '營養師', '營養評估', '院友有營養不良或營養風險',
   ARRAY['改善營養狀況', '達到每日營養需求', '減低營養風險評分'],
   ARRAY['營養評估', '營養補充計劃', '監測體重', '高蛋白飲食', '營養品使用'],
   ARRAY['營養不良', '風險', '評估', '蛋白質', 'MNA']),
  
  ('DT004', '吞嚥適應飲食', '營養師', '質地調整', '院友需要調整食物質地飲食',
   ARRAY['安全進食', '維持營養攝取', '享受飲食樂趣'],
   ARRAY['質地評估', '餐單調整', '增稠劑使用', '營養密度提升', '烹調方法指導'],
   ARRAY['吞嚥', '質地', '糊餐', '碎餐', '增稠']),
  
  ('DT005', '腎病飲食管理', '營養師', '治療飲食', '院友需要腎病適用飲食',
   ARRAY['控制腎功能指標', '減慢腎病進展', '維持營養'],
   ARRAY['低蛋白飲食', '限鉀限磷', '水分管理', '定期化驗監測', '飲食教育'],
   ARRAY['腎病', '透析', '鉀', '磷', '蛋白質']),
  
  ('DT006', '高血壓飲食管理', '營養師', '治療飲食', '院友需要控制血壓飲食',
   ARRAY['穩定血壓', '減少鈉攝取', '達到理想體重'],
   ARRAY['低鈉飲食', 'DASH飲食', '鉀鈣鎂補充', '體重管理', '飲食日誌'],
   ARRAY['高血壓', '鈉', '鹽', '血壓', '心血管']),
  
  ('DT007', '傷口癒合營養', '營養師', '特殊營養', '院友有傷口需營養支援癒合',
   ARRAY['促進傷口癒合', '維持正氮平衡', '預防感染'],
   ARRAY['高蛋白飲食', '維他命C補充', '鋅補充', '熱量充足', '水份足夠'],
   ARRAY['傷口', '癒合', '蛋白質', '維他命', '營養']),
  
  ('DT008', '管灌營養', '營養師', '腸道營養', '院友需要鼻胃管或胃造口餵食',
   ARRAY['達到營養需求', '維持腸道功能', '預防併發症'],
   ARRAY['管灌配方選擇', '餵食計劃制定', '監測耐受性', '水份計算', '定期評估'],
   ARRAY['管灌', '鼻胃管', '胃造口', 'PEG', '餵食']),
  
  ('DT009', '體重過重', '營養師', '體重管理', '院友體重過重需要管理',
   ARRAY['達到理想體重', '改善代謝指標', '提升活動能力'],
   ARRAY['熱量控制', '飲食日誌', '運動配合', '行為改變', '定期監測'],
   ARRAY['過重', '肥胖', 'BMI', '減重', '熱量']),
  
  ('DT010', '食慾不振', '營養師', '食慾問題', '院友食慾下降或拒食',
   ARRAY['改善食慾', '增加進食量', '維持體重'],
   ARRAY['找出原因', '少量多餐', '食物改善', '進餐環境', '藥物檢視'],
   ARRAY['食慾', '拒食', '進食', '胃口', '厭食']),
  
  ('DT011', '素食營養管理', '營養師', '特殊飲食', '素食院友營養需要管理',
   ARRAY['達到營養需求', '預防營養缺乏', '尊重飲食選擇'],
   ARRAY['素食餐單設計', 'B12補充', '蛋白質來源多元化', '鈣鐵補充', '定期監測'],
   ARRAY['素食', '蛋白質', 'B12', '營養', '植物性']),
  
  ('DT012', '食物過敏管理', '營養師', '食物安全', '院友有食物過敏需要管理',
   ARRAY['避免過敏反應', '確保營養均衡', '安全飲食'],
   ARRAY['過敏原識別', '餐單調整', '替代食物', '標籤閱讀', '緊急處理教育'],
   ARRAY['過敏', '敏感', '食物', '反應', '避免'])
ON CONFLICT (code) DO UPDATE SET
  subcategory = EXCLUDED.subcategory,
  keywords = EXCLUDED.keywords;

-- 創建索引以支援關鍵字搜索
CREATE INDEX IF NOT EXISTS idx_problem_library_keywords ON problem_library USING GIN (keywords);
CREATE INDEX IF NOT EXISTS idx_problem_library_subcategory ON problem_library(subcategory);

-- 完成
COMMENT ON COLUMN problem_library.subcategory IS '問題子分類';
COMMENT ON COLUMN problem_library.keywords IS '搜索關鍵字陣列';
