# 衛生記錄內嵌式布局設計

## 📋 設計目標

- ❌ 不使用模態框（Modal）
- ✅ 直接在表格中顯示和編輯
- ✅ 每天一次，簡化操作流程
- ✅ 支持快速批量錄入
- ✅ Web 和 Mobile 統一體驗

---

## 🎨 布局方案 A：橫向滾動表格（推薦 Web）

### 表格結構

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│  衛生記錄 - 張三 (床號: A101)                              本週: 12/18 - 12/24      │
├─────────┬───────┬───────┬───────┬───────┬───────┬───────┬───────┬──────────────────┤
│  日期   │ 12/18 │ 12/19 │ 12/20 │ 12/21 │ 12/22 │ 12/23 │ 12/24 │   護理項目      │
│         │  週一 │  週二 │  週三 │  週四 │  週五 │  週六 │  週日 │                  │
├─────────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼──────────────────┤
│  沐浴   │   ✓   │   ✓   │   -   │   ✓   │   -   │   -   │   -   │  11項護理項目    │
├─────────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┤  垂直排列        │
│  洗面   │   ✓   │   ✓   │   ✓   │   ✓   │   -   │   -   │   -   │                  │
├─────────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┤  點擊切換狀態    │
│  剃鬚   │   -   │   -   │   ✓   │   -   │   -   │   -   │   -   │                  │
├─────────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┤                  │
│ 洗牙漱口│   ✓   │   ✓   │   ✓   │   ✓   │   -   │   -   │   -   │                  │
├─────────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┤                  │
│ 洗假牙  │   ✓   │   ✓   │   ✓   │   ✓   │   -   │   -   │   -   │                  │
├─────────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┤                  │
│剪指甲   │   -   │   -   │   -   │   ✓   │   -   │   -   │   -   │                  │
├─────────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┤                  │
│換被套   │   -   │   -   │   ✓   │   -   │   -   │   -   │   -   │                  │
├─────────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┤                  │
│換床單   │   ✓   │   -   │   -   │   ✓   │   -   │   -   │   -   │                  │
├─────────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┤                  │
│ 洗杯    │   ✓   │   ✓   │   ✓   │   ✓   │   -   │   -   │   -   │                  │
├─────────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┤                  │
│整理床櫃 │   ✓   │   -   │   ✓   │   -   │   -   │   -   │   -   │                  │
├─────────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┤                  │
│整理衣箱 │   ✓   │   -   │   ✓   │   -   │   -   │   -   │   -   │                  │
├─────────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴──────────────────┤
│  大便記錄（點擊展開）                                                                │
├─────────┬───────┬───────┬───────┬───────┬───────┬───────┬───────┬──────────────────┤
│  次數   │   2   │   1   │  無   │   1   │   -   │   -   │   -   │  點擊編輯        │
├─────────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┤                  │
│  量     │  中   │  少   │   -   │  中   │   -   │   -   │   -   │                  │
├─────────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┤                  │
│ 性質    │  軟   │  硬   │   -   │  軟   │   -   │   -   │   -   │                  │
├─────────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴──────────────────┤
│  特殊狀態                                                                            │
├─────────┬───────┬───────┬───────┬───────┬───────┬───────┬───────┬──────────────────┤
│  狀態   │   -   │   -   │ 渡假  │   -   │   -   │   -   │   -   │  入院/渡假/外出  │
├─────────┼───────┼───────┼───────┼───────┼───────┼───────┼───────┼──────────────────┤
│ 記錄者  │ 王護士│ 李護士│   -   │ 王護士│   -   │   -   │   -   │  自動填入        │
└─────────┴───────┴───────┴───────┴───────┴───────┴───────┴───────┴──────────────────┘
```

---

## 🎨 布局方案 B：縱向卡片式（推薦 Mobile）

### 單日卡片展開視圖

```
┌────────────────────────────────────────┐
│  📅 2024年12月21日 (週四)              │
│  ┌──────────────────────────────────┐  │
│  │  護理項目                         │  │
│  │  ┌────┬────┬────┬────┬────┬────┐│  │
│  │  │ ✓  │ ✓  │    │ ✓  │ ✓  │    ││  │
│  │  │沐浴│洗面│剃鬚│漱口│假牙│指甲││  │
│  │  └────┴────┴────┴────┴────┴────┘│  │
│  │                                  │  │
│  │  ┌────┬────┬────┬────┬────┐    │  │
│  │  │    │ ✓  │ ✓  │    │    │    │  │
│  │  │被套│床單│洗杯│床櫃│衣箱│    │  │
│  │  └────┴────┴────┴────┴────┘    │  │
│  └──────────────────────────────────┘  │
│                                        │
│  ┌──────────────────────────────────┐  │
│  │  💩 大便記錄                      │  │
│  │  次數: [1] 次    量: [中]        │  │
│  │  性質: [軟]                      │  │
│  └──────────────────────────────────┘  │
│                                        │
│  ┌──────────────────────────────────┐  │
│  │  狀態: [入院] [渡假] [外出]      │  │
│  │  記錄者: 王護士  ⏰ 14:30        │  │
│  └──────────────────────────────────┘  │
│                                        │
│  [ 保存 ]             [ 清除本日 ]    │
└────────────────────────────────────────┘
```

### 一週概覽視圖（折疊）

```
┌────────────────────────────────────────┐
│  衛生記錄 - 本週                       │
├────────────────────────────────────────┤
│  📅 12/18 (週一)          ▼            │
│     ✓ 7項完成  💩 1次  王護士          │
├────────────────────────────────────────┤
│  📅 12/19 (週二)          ▼            │
│     ✓ 5項完成  💩 2次  李護士          │
├────────────────────────────────────────┤
│  📅 12/20 (週三)          ▼            │
│     🏖️ 渡假                            │
├────────────────────────────────────────┤
│  📅 12/21 (週四)          ▼            │
│     ⚠️ 未記錄                          │
├────────────────────────────────────────┤
│  📅 12/22 (週五)          ▼            │
│     ⚠️ 未記錄                          │
├────────────────────────────────────────┤
│  📅 12/23 (週六)          ▼            │
│     ⚠️ 未記錄                          │
├────────────────────────────────────────┤
│  📅 12/24 (週日)          ▼            │
│     ⚠️ 未記錄                          │
└────────────────────────────────────────┘
```

---

## 🎨 布局方案 C：混合式（最優方案）

### Web 端：橫向表格 + 快速編輯浮窗

**主表格（簡化視圖）**
```
┌──────────────────────────────────────────────────────────────────────┐
│  衛生記錄                                         2024年12月第3週    │
├────────┬───────┬───────┬───────┬───────┬───────┬───────┬───────────┤
│  項目  │ 週一  │ 週二  │ 週三  │ 週四  │ 週五  │ 週六  │ 週日     │
│        │ 12/18 │ 12/19 │ 12/20 │ 12/21 │ 12/22 │ 12/23 │ 12/24    │
├────────┼───────┼───────┼───────┼───────┼───────┼───────┼───────────┤
│ 護理   │  7/11 │  5/11 │   -   │  0/11 │  0/11 │  0/11 │  0/11    │
│ 項目   │   ✓   │   ✓   │ 渡假  │   📝  │   📝  │   📝  │   📝     │
├────────┼───────┼───────┼───────┼───────┼───────┼───────┼───────────┤
│ 大便   │  💩1  │  💩2  │   -   │   📝  │   📝  │   📝  │   📝     │
├────────┼───────┼───────┼───────┼───────┼───────┼───────┼───────────┤
│ 記錄者 │ 王護士│ 李護士│   -   │   -   │   -   │   -   │   -      │
└────────┴───────┴───────┴───────┴───────┴───────┴───────┴───────────┘

點擊 📝 圖標展開快速編輯面板 ↓
```

**快速編輯面板（點擊單元格後彈出，非模態）**
```
┌─────────────────────────────────────────────────┐
│  📅 2024年12月21日 (週四) - 快速編輯            │
├─────────────────────────────────────────────────┤
│  護理項目 (點擊切換)                            │
│  ┌──┬──┬──┬──┬──┬──┐                         │
│  │✓ │✓ │  │✓ │✓ │  │                          │
│  │浴│面│鬚│口│牙│甲│                          │
│  └──┴──┴──┴──┴──┴──┘                         │
│  ┌──┬──┬──┬──┬──┐                            │
│  │  │✓ │✓ │  │  │                             │
│  │被│單│杯│櫃│箱│                             │
│  └──┴──┴──┴──┴──┘                            │
│                                                 │
│  大便記錄                                       │
│  次數: [ 1 ▼]  量: [中 ▼]  性質: [軟 ▼]       │
│                                                 │
│  特殊狀態: [ ] 入院  [ ] 渡假  [ ] 外出        │
│  記錄者: 王護士                                 │
│                                                 │
│  [✓ 保存] [✗ 取消]                             │
└─────────────────────────────────────────────────┘
```

### Mobile 端：可展開列表

**折疊狀態**
```
┌──────────────────────────┐
│  📅 12/21 (四)     ▶     │
│  ⚠️ 未記錄               │
└──────────────────────────┘
```

**展開狀態**
```
┌──────────────────────────────────┐
│  📅 12/21 (四)     ▼              │
├──────────────────────────────────┤
│  護理項目                         │
│  [✓浴] [✓面] [ 鬚] [✓口] [✓牙]  │
│  [ 甲] [ 被] [✓單] [✓杯] [ 櫃]  │
│  [ 箱]                           │
├──────────────────────────────────┤
│  大便: 1次 中量 軟                │
│  記錄者: 王護士                   │
│  [ 編輯 ]                        │
└──────────────────────────────────┘
```

---

## 💡 交互設計細節

### 1. 護理項目切換
- **Web**: 點擊單元格切換 ✓ / - 狀態
- **Mobile**: 按鈕式切換，已選綠色背景，未選灰色

### 2. 大便記錄
- **快速模式**: 顯示簡化圖標（💩1、💩2、無）
- **詳細模式**: 點擊展開下拉選擇器

### 3. 特殊狀態（入院/渡假/外出）
- 選中後該日所有項目變灰，不可編輯
- 顯示橙色背景標識

### 4. 自動保存
- **Web**: 點擊單元格後延遲 500ms 自動保存
- **Mobile**: 展開編輯後點擊保存按鈕

### 5. 視覺反饋
- ✅ 已完成：綠色勾選
- ❌ 未完成：灰色橫線
- 🏖️ 特殊狀態：橙色背景 + 文字
- ⚠️ 未記錄：紅色警告（超過當天 23:59）

---

## 📱 響應式設計

### Web 大屏（>1200px）
- 方案 A：完整橫向表格
- 顯示一週 7 天
- 護理項目垂直排列

### Web 中屏（768px-1200px）
- 方案 C：簡化表格 + 快速編輯面板
- 顯示一週 7 天
- 護理項目分組顯示

### Mobile（<768px）
- 方案 B/C：可展開列表
- 每天獨立卡片
- 滑動查看其他日期

---

## 🎯 推薦實施方案

### Web 端
**採用方案 C（混合式）**
- 主表格顯示概覽（已完成項目數/總數、大便記錄、記錄者）
- 點擊單元格彈出快速編輯面板（非模態，position: absolute）
- 支持鍵盤快捷鍵（Tab 切換、Enter 確認、Esc 取消）

### Mobile 端
**採用方案 B（縱向卡片式）**
- 一週概覽列表（可折疊/展開）
- 展開後直接在卡片內編輯
- 點擊保存按鈕提交

---

## 🔧 技術實現要點

### 1. 數據結構
```typescript
interface DailyHygieneData {
  date: string;
  items: {
    bath: boolean;
    face_wash: boolean;
    // ... 其他 11 項
  };
  bowel: {
    count: number | null;
    amount: '少' | '中' | '多' | null;
    consistency: '硬' | '軟' | '稀' | '水狀' | null;
  };
  status: '入院' | '渡假' | '外出' | null;
  recorder: string;
}
```

### 2. 狀態管理
- 使用 useState 管理整週數據
- Optimistic UI 更新（先更新界面，後台異步保存）
- 失敗時回滾

### 3. 性能優化
- 使用 React.memo 避免不必要的重渲染
- 防抖保存（500ms）
- 虛擬滾動（如果護理項目很多）

---

## 📊 布局對比總結

| 特性         | 方案A（橫向表格） | 方案B（縱向卡片） | 方案C（混合式） |
|-------------|------------------|------------------|----------------|
| 適用場景     | Web 大屏         | Mobile           | Web 全尺寸     |
| 一眼概覽     | ⭐⭐⭐⭐⭐      | ⭐⭐⭐          | ⭐⭐⭐⭐       |
| 編輯效率     | ⭐⭐⭐⭐        | ⭐⭐⭐⭐        | ⭐⭐⭐⭐⭐     |
| 手機友好     | ⭐⭐            | ⭐⭐⭐⭐⭐      | ⭐⭐⭐         |
| 實現複雜度   | 中等             | 簡單             | 較高           |
| 批量錄入     | ⭐⭐⭐⭐⭐      | ⭐⭐⭐          | ⭐⭐⭐⭐⭐     |

**最終推薦：**
- **Web**: 方案 C（混合式）
- **Mobile**: 方案 B（縱向卡片式）
